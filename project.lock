build_documents_manifest:
  cmd: python -m weasel run build_documents_manifest
  script:
    - python scripts/build_documents_manifest.py /Users/dtubb/code/fichero/projects/demo_small/documents
      /Users/dtubb/code/fichero/projects/demo_small/assets/manifests/documents_manifest.jsonl
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/manifests/documents_manifest.jsonl
      md5: 268752f52aa84fb03ef3d5bc2aefc36b
crop:
  cmd: python -m weasel run crop
  script:
    - python scripts/crop.py /Users/dtubb/code/fichero/projects/demo_small/documents
      /Users/dtubb/code/fichero/projects/demo_small/assets/manifests/documents_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/crops
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/crops
      md5: 07eb6dd37d037c402129c2240adca9f8
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/crops/crop_manifest.jsonl
      md5: 2af9fad16c3e94e42d7e53b4eb756138
split:
  cmd: python -m weasel run split
  script:
    - python scripts/split.py /Users/dtubb/code/fichero/projects/demo_small/assets/crops
      /Users/dtubb/code/fichero/projects/demo_small/assets/crops/crop_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/splits
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/splits
      md5: 4571ebdfe7c3083f1559aac13db8ff74
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/splits/split_manifest.jsonl
      md5: 1cd38c13a858388d4d70440ecef48576
rotate:
  cmd: python -m weasel run rotate
  script:
    - python scripts/rotate.py /Users/dtubb/code/fichero/projects/demo_small/assets/splits
      /Users/dtubb/code/fichero/projects/demo_small/assets/splits/split_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/rotated
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/rotated
      md5: ca4e929c487d79eb736adbddf82b2f21
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/rotated/rotate_manifest.jsonl
      md5: 070265425b8115259242b9f0549b5d2f
enhance:
  cmd: python -m weasel run enhance
  script:
    - python scripts/enhance.py /Users/dtubb/code/fichero/projects/demo_small/assets/rotated
      /Users/dtubb/code/fichero/projects/demo_small/assets/rotated/rotate_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/enhanced
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/enhanced
      md5: 26fa798ef14103d74d930df6b063fba4
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/enhanced/enhance_manifest.jsonl
      md5: 2990ed686f0608ece32a16855653db28
remove_background:
  cmd: python -m weasel run remove_background
  script:
    - python scripts/remove_background.py /Users/dtubb/code/fichero/projects/demo_small/assets/enhanced
      /Users/dtubb/code/fichero/projects/demo_small/assets/enhanced/enhance_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      md5: 476133845747f631fa794f99b3610299
transcribe_qwen_2b:
  cmd: python -m weasel run transcribe_qwen_2b
  script:
    - python scripts/transcribe_qwen_2b.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
      md5: 4765c174c06911eadc2b5424840a8210
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      md5: 47f023ef2ea23e310e1ca87488ada5be
convert_transcribe_to_word:
  cmd: python -m weasel run convert_transcribe_to_word
  script:
    - python scripts/convert_to_word.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/word /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/word
      md5: 9def3440c142695505a264553c9caff9
transcribe_qwen_max:
  cmd: python -m weasel run transcribe_qwen_max
  script:
    - python scripts/transcribe_qwen_max.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
      md5: d743984e7f524210aa2f13a0b64fa227
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      md5: fed5fce6acb93ec139ff1bda914ed888
segment:
  cmd: python -m weasel run segment
  script:
    - python scripts/segment.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/segments
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segments
      md5: 8080f2549ac23ee595860d1ff993d7ee
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segments/segment_manifest.jsonl
      md5: 4b0abe4cd52f672c3d34824b5e77a298
transcribe_qwen_max_segments:
  cmd: python -m weasel run transcribe_qwen_max_segments
  script:
    - python scripts/transcribe_qwen_max.py /Users/dtubb/code/fichero/projects/demo_small/assets/segments
      /Users/dtubb/code/fichero/projects/demo_small/assets/segments/segment_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      md5: da4e920803da1e4882f92a025a6f884d
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions/transcription_manifest.jsonl
      md5: e9f249bbf7fcf7ae8c0da0b6f04b1548
recombine_segments_qwen_max:
  cmd: python -m weasel run recombine_segments_qwen_max
  script:
    - python scripts/recombine_segments.py /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      /Users/dtubb/code/fichero/projects/demo_small/assets/recombined /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions/transcription_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/recombined
      md5: 2c599a4efed93c31735eaa38de23e8ca
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/recombined/recombine_manifest.jsonl
      md5: 0816c9351805956250708dd683435ab3
fuzzy_clean:
  cmd: python -m weasel run fuzzy_clean
  script:
    - python scripts/fuzzy_clean.py /Users/dtubb/code/fichero/projects/demo_small/assets/recombined
      /Users/dtubb/code/fichero/projects/demo_small/assets/recombined/recombine_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
      md5: cef7c7f275cfe347fd4869ac96240c5b
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      md5: c608857c7d0c8b0b5204010db037513f
convert_segmented_to_word:
  cmd: python -m weasel run convert_segmented_to_word
  script:
    - python scripts/convert_segmented_to_word.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/cleaned/fuzzy_clean_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/word /Users/dtubb/code/fichero/projects/demo_small/assets/cleaned/documents
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/word
      md5: 7d931bf6cc83a1e6696d156b10e34a7c
convert_to_word:
  cmd: python -m weasel run convert_to_word
  script:
    - python scripts/convert_to_word.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/word
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/word
      md5: e6a56ea30a6beed714da76e9d0a60d40
transcribe_qwen_2b_segments:
  cmd: python -m weasel run transcribe_qwen_2b_segments
  script:
    - python scripts/transcribe_qwen_2b.py /Users/dtubb/code/fichero/projects/demo_small/assets/segments/documents
      /Users/dtubb/code/fichero/projects/demo_small/assets/segments/segment_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      md5: bc321bcb99bbd3160f7e29275aec5f17
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions/transcription_manifest.jsonl
      md5: 6e046eba97541708a47783e2c6d2b61a
recombine_segments:
  cmd: python -m weasel run recombine_segments
  script:
    - python scripts/recombine_segments.py /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      /Users/dtubb/code/fichero/projects/demo_small/assets/recombined /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions/transcription_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/recombined
      md5: 1d40b05357851cca20e78f7a770bab07
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/recombined/recombine_manifest.jsonl
      md5: 0816c9351805956250708dd683435ab3
transcribe_qwen_7b:
  cmd: python -m weasel run transcribe_qwen_7b
  script:
    - python scripts/transcribe_qwen_7b.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
      md5: dd8366981e540e5d10e48ce67bc81b37
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      md5: faa12e39eff1773f90c468b5d45d0d05
transcribe_qwen_7b_segments:
  cmd: python -m weasel run transcribe_qwen_7b_segments
  script:
    - python scripts/transcribe_qwen_7b.py /Users/dtubb/code/fichero/projects/demo_small/assets/segments/documents
      /Users/dtubb/code/fichero/projects/demo_small/assets/segments/segment_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      md5: b14f30dae32653943022b46feeb7a683
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions/transcription_manifest.jsonl
      md5: a5eef22a1dd7702fbf2e23e657acb5e7
transcribe_lmstudio:
  cmd: python -m weasel run transcribe_lmstudio
  script:
    - python scripts/transcribe_lmstudio.py /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed
      /Users/dtubb/code/fichero/projects/demo_small/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions --model
      qwen2.5-vl-7b-instruct
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions
      md5: 1d32342b48111f32f52a4e18a14a054e
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/transcriptions/transcription_manifest.jsonl
      md5: 580a66b38d54fd979bf50f042eeb17a2
transcribe_lmstudio_segments:
  cmd: python -m weasel run transcribe_lmstudio_segments
  script:
    - python scripts/transcribe_lmstudio.py /Users/dtubb/code/fichero/projects/demo_small/assets/segments/documents
      /Users/dtubb/code/fichero/projects/demo_small/assets/segments/segment_manifest.jsonl
      /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      --model Qwen2.5-VL-3B-Instruct-8bit
  deps: []
  outs:
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions
      md5: e299ccafe29cd2933a87db9beaf7b5b2
    - path: /Users/dtubb/code/fichero/projects/demo_small/assets/segmented_transcriptions/transcription_manifest.jsonl
      md5: d22b66b7443ec9e52e3cb4d38aca3910
