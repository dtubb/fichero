build_documents_manifest:
  cmd: python -m weasel run build_documents_manifest
  script:
    - python scripts/build_documents_manifest.py projects/demo/documents projects/demo/assets/manifests/documents_manifest.jsonl
  deps: []
  outs:
    - path: projects/demo/assets/manifests/documents_manifest.jsonl
      md5: da89b5aacf8b367ce62d2b2cbd606e38
crop:
  cmd: python -m weasel run crop
  script:
    - python scripts/crop.py projects/demo/documents projects/demo/assets/manifests/documents_manifest.jsonl
      projects/demo/assets/crops
  deps: []
  outs:
    - path: projects/demo/assets/crops
      md5: bd9db91ee5f52b7216c38ac0fe013d40
    - path: projects/demo/assets/crops/crop_manifest.jsonl
      md5: 3d806fed0a3ca58caa5bd271eb77a184
split:
  cmd: python -m weasel run split
  script:
    - python scripts/split.py projects/demo/assets/crops projects/demo/assets/crops/crop_manifest.jsonl
      projects/demo/assets/splits
  deps: []
  outs:
    - path: projects/demo/assets/splits
      md5: 76b721baa516ee7583e315d6f1ed1a3d
    - path: projects/demo/assets/splits/split_manifest.jsonl
      md5: 40919baa0b94a78d25e2997caf7a6b22
rotate:
  cmd: python -m weasel run rotate
  script:
    - python scripts/rotate.py projects/demo/assets/splits projects/demo/assets/splits/split_manifest.jsonl
      projects/demo/assets/rotated
  deps: []
  outs:
    - path: projects/demo/assets/rotated
      md5: 46c440c20d3dd51c1df7051b68a8e068
    - path: projects/demo/assets/rotated/rotate_manifest.jsonl
      md5: d588184ffca9406dd15ca6f3f8b57faf
enhance:
  cmd: python -m weasel run enhance
  script:
    - python scripts/enhance.py projects/demo/assets/rotated projects/demo/assets/rotated/rotate_manifest.jsonl
      projects/demo/assets/enhanced
  deps: []
  outs:
    - path: projects/demo/assets/enhanced
      md5: 1c65d1e56c3857ecc085c36d9eff2a77
    - path: projects/demo/assets/enhanced/enhance_manifest.jsonl
      md5: 1e07c336490a1f50ea0207842a2339ba
remove_background:
  cmd: python -m weasel run remove_background
  script:
    - python scripts/remove_background.py projects/demo/assets/enhanced projects/demo/assets/enhanced/enhance_manifest.jsonl
      projects/demo/assets/background_removed
  deps: []
  outs:
    - path: projects/demo/assets/background_removed
      md5: b332f05ffe3d46a6cc6f9f7727abf8af
transcribe_qwen_max:
  cmd: python -m weasel run transcribe_qwen_max
  script:
    - python scripts/transcribe_qwen_max.py projects/demo/assets/background_removed
      projects/demo/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      projects/demo/assets/transcriptions
  deps: []
  outs:
    - path: projects/demo/assets/transcriptions
      md5: b1ae08d1bde6494bbc3c632923f159bc
    - path: projects/demo/assets/transcriptions/transcription_manifest.jsonl
      md5: 294a39eecc9127c3f625ab62f1125221
convert_transcribe_to_word:
  cmd: python -m weasel run convert_transcribe_to_word
  script:
    - python scripts/convert_to_word.py projects/demo/assets/background_removed projects/demo/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      projects/demo/assets/transcriptions/transcription_manifest.jsonl projects/demo/assets/word
      projects/demo/assets/transcriptions
  deps: []
  outs:
    - path: projects/demo/assets/word
      md5: 2239684a2b4442ea7176b1478e19a702
segment:
  cmd: python -m weasel run segment
  script:
    - python scripts/segment.py projects/demo/assets/background_removed projects/demo/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      projects/demo/assets/segments
  deps: []
  outs:
    - path: projects/demo/assets/segments
      md5: d715375d43874e981ac453aaed1ea170
    - path: projects/demo/assets/segments/segment_manifest.jsonl
      md5: 784a57fe939bf09e963c976852b9af2c
transcribe_qwen_max_segments:
  cmd: python -m weasel run transcribe_qwen_max_segments
  script:
    - python scripts/transcribe_qwen_max.py projects/demo/assets/segments/documents
      projects/demo/assets/segments/segment_manifest.jsonl projects/demo/assets/transcriptions
  deps: []
  outs:
    - path: projects/demo/assets/transcriptions
      md5: b147a6e856257f2d81948757161ee6ec
    - path: projects/demo/assets/transcriptions/transcription_manifest.jsonl
      md5: b5dfdc5e990cb85042aed3742d06a8f8
recombine_segments_qwen_max:
  cmd: python -m weasel run recombine_segments_qwen_max
  script:
    - python scripts/recombine_segments.py projects/demo/assets/transcriptions projects/demo/assets/recombined
      projects/demo/assets/transcriptions/transcription_manifest.jsonl projects/demo/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
  deps: []
  outs:
    - path: projects/demo/assets/recombined
      md5: fdffd3cf951499c9cf0df45a6d2e559b
    - path: projects/demo/assets/recombined/recombine_manifest.jsonl
      md5: cf3782f9196114f508c8acd87d82a12f
fuzzy_clean:
  cmd: python -m weasel run fuzzy_clean
  script:
    - python scripts/fuzzy_clean.py projects/demo/assets/recombined projects/demo/assets/recombined/recombine_manifest.jsonl
      projects/demo/assets/cleaned
  deps: []
  outs:
    - path: projects/demo/assets/cleaned
      md5: d1b2290e67fbdce910f8b1ad4e36a95b
    - path: projects/demo/assets/cleaned/fuzzy_clean_manifest.jsonl
      md5: bb2c5a67088e4c4e5d5d0c12a0b0ef73
convert_segmented_to_word:
  cmd: python -m weasel run convert_segmented_to_word
  script:
    - python scripts/convert_to_word.py projects/demo/assets/background_removed projects/demo/assets/background_removed/remove_multi_obj_black_bg_manifest.jsonl
      projects/demo/assets/cleaned/fuzzy_clean_manifest.jsonl projects/demo/assets/word
      projects/demo/assets/cleaned
  deps: []
  outs:
    - path: projects/demo/assets/word
      md5: 7f981d215c92ae4db1cdbc888c6ed41f
transcribe_qwen_2b:
  cmd: python -m weasel run transcribe_qwen_2b
  script:
    - python scripts/transcribe_qwen_2b.py projects/demo/assets/segments projects/demo/assets/segments/segment_manifest.jsonl
      projects/demo/assets/transcriptions
  deps: []
  outs:
    - path: projects/demo/assets/transcriptions
      md5: a08043eeb2cca3f3fb192519132bc270
    - path: projects/demo/assets/transcriptions/transcription_manifest.jsonl
      md5: d4be5c44c02891db512bd23af8334068
